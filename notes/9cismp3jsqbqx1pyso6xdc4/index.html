<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><title>Supervised Contrastive Learning</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="kavlogs"/><meta property="og:title" content="Supervised Contrastive Learning"/><meta property="og:description" content="kavlogs"/><meta property="og:url" content="https://kavorite.github.io/vault/notes/9cismp3jsqbqx1pyso6xdc4/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="5/22/2022"/><meta property="article:modified_time" content="7/29/2022"/><link rel="canonical" href="https://kavorite.github.io/vault/notes/9cismp3jsqbqx1pyso6xdc4/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/vault/_next/static/css/bec73badd4e5ba88.css" as="style"/><link rel="stylesheet" href="/vault/_next/static/css/bec73badd4e5ba88.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/vault/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/vault/_next/static/chunks/webpack-3af8c0cde089b23c.js" defer=""></script><script src="/vault/_next/static/chunks/framework-bb5c596eafb42b22.js" defer=""></script><script src="/vault/_next/static/chunks/main-34d019fcedb697b6.js" defer=""></script><script src="/vault/_next/static/chunks/pages/_app-b20c4be9bb651ea8.js" defer=""></script><script src="/vault/_next/static/chunks/826-e0e455fb469c158f.js" defer=""></script><script src="/vault/_next/static/chunks/986-737e5da213076068.js" defer=""></script><script src="/vault/_next/static/chunks/pages/notes/%5Bid%5D-00dd1421f3ce3a3e.js" defer=""></script><script src="/vault/_next/static/x67zoUTAB0zyGOxjfffun/_buildManifest.js" defer=""></script><script src="/vault/_next/static/x67zoUTAB0zyGOxjfffun/_ssgManifest.js" defer=""></script><script src="/vault/_next/static/x67zoUTAB0zyGOxjfffun/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><section class="ant-layout side-layout-main" style="max-width:1200px;display:initial"><main class="ant-layout-content main-content" role="main" style="padding:0 24px"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="supervised-contrastive-learning"><a aria-hidden="true" class="anchor-heading icon-link" href="#supervised-contrastive-learning"></a>Supervised Contrastive Learning</h1>
<p><a href="https://paperswithcode.com/paper/supervised-contrastive-learning">Khosla, et al., 2021</a> (<a href="https://ai.googleblog.com/2021/06/extending-contrastive-learning-to.html">blog</a>) verified that supervised instance discrimination is more sample-efficient than direct supervision and leads to more distinct class embeddings, even when a set of training labels is provided for input samples. The publication attributes this property to the high number of negative instance samples available for providing supervisory signal on <em>one another</em> within a minibatch.</p>
<p>According to the developers of the <a href="https://github.com/HobbitLong/SupContrast">official implementation</a>, at small minibatch sizes, a <a href="/vault/notes/uihquvh4fwgniynh3aly42g">momentum encoder</a> and dictionary are necessary to attain competitive performance. However, it should be possible to offset this technical overhead and hyperparameter sensitivity in a multi-device training regime by performing a rendezvous to synchronize replicated latent representations across minibatches with functionality such as <code>jax.lax.all_gather</code>, or by adding more positive examples with strong data augmentation, akin to a supervised form of <a href="/vault/notes/uihquvh4fwgniynh3aly42g#fast-moco">Fast-MoCo</a>. </p>
<p>It is unclear how the added positive examples would affect stability or performance— particularly with noisy labels or multiple labels assigned to training instances. To help correct for this, and because the supervisory signal may come from an underlying symbolic hierarchy with this method, it may be worth exploring projection of this method's latent embedding space onto a <a href="/vault/notes/ikhbh5ldwpxjjb3ev2aacu0">Poincaré ball</a>.</p>
<p><img src="/vault/assets/images/supcon.png" alt="Supervised Contrastive Learning"></p>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/vault/notes/jc56h8njgqawadlroex4ju1">Contrastive Learning (vault)</a></li>
<li><a href="/vault/notes/63z6zjmnp5tg1pj2rwcfb2f">Contrastive Language-Image Pretraining (vault)</a></li>
<li><a href="/vault/notes/uihquvh4fwgniynh3aly42g">Momentum Contrast (vault)</a></li>
<li><a href="/vault/notes/ikhbh5ldwpxjjb3ev2aacu0">Hyperbolic Geometry (vault)</a></li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div></div></div></div></div></div></div></div></div></main><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></section></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"9cismp3jsqbqx1pyso6xdc4","title":"Supervised Contrastive Learning","desc":"","updated":1659056602441,"created":1653188946537,"custom":{},"fname":"ref.cl.supcon","type":"note","vault":{"fsPath":"vault"},"contentHash":"595e1b51a7e092ddff7591fc869d88e3","links":[{"type":"wiki","from":{"fname":"ref.cl.supcon","id":"9cismp3jsqbqx1pyso6xdc4","vaultName":"vault"},"value":"ref.cl.moco","alias":"momentum encoder","position":{"start":{"line":4,"column":99,"offset":517},"end":{"line":4,"column":131,"offset":549},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"ref.cl.moco"}},{"type":"wiki","from":{"fname":"ref.cl.supcon","id":"9cismp3jsqbqx1pyso6xdc4","vaultName":"vault"},"value":"ref.cl.moco","alias":"Fast-MoCo","position":{"start":{"line":4,"column":566,"offset":984},"end":{"line":4,"column":601,"offset":1019},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"ref.cl.moco","anchorHeader":"Fast-MoCo"}},{"type":"wiki","from":{"fname":"ref.cl.supcon","id":"9cismp3jsqbqx1pyso6xdc4","vaultName":"vault"},"value":"ref.opt.hyperbolics","alias":"Poincaré ball","position":{"start":{"line":6,"column":378,"offset":1400},"end":{"line":6,"column":415,"offset":1437},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"ref.opt.hyperbolics"}},{"from":{"fname":"ref.cl","vaultName":"vault"},"type":"backlink","position":{"start":{"line":13,"column":407,"offset":2120},"end":{"line":13,"column":424,"offset":2137},"indent":[]},"value":"ref.cl.supcon","alias":"ref.cl.supcon"},{"from":{"fname":"ref.cl.clip","vaultName":"vault"},"type":"backlink","position":{"start":{"line":1,"column":356,"offset":355},"end":{"line":1,"column":373,"offset":372},"indent":[]},"value":"ref.cl.supcon","alias":"ref.cl.supcon"},{"from":{"fname":"ref.cl.moco","vaultName":"vault"},"type":"backlink","position":{"start":{"line":1,"column":359,"offset":358},"end":{"line":1,"column":376,"offset":375},"indent":[]},"value":"ref.cl.supcon","alias":"ref.cl.supcon"},{"from":{"fname":"ref.opt.hyperbolics","vaultName":"vault"},"type":"backlink","position":{"start":{"line":5,"column":245,"offset":1406},"end":{"line":5,"column":262,"offset":1423},"indent":[]},"value":"ref.cl.supcon","alias":"ref.cl.supcon"}],"anchors":{},"children":[],"parent":"jc56h8njgqawadlroex4ju1","data":{}},"body":"\u003ch1 id=\"supervised-contrastive-learning\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#supervised-contrastive-learning\"\u003e\u003c/a\u003eSupervised Contrastive Learning\u003c/h1\u003e\n\u003cp\u003e\u003ca href=\"https://paperswithcode.com/paper/supervised-contrastive-learning\"\u003eKhosla, et al., 2021\u003c/a\u003e (\u003ca href=\"https://ai.googleblog.com/2021/06/extending-contrastive-learning-to.html\"\u003eblog\u003c/a\u003e) verified that supervised instance discrimination is more sample-efficient than direct supervision and leads to more distinct class embeddings, even when a set of training labels is provided for input samples. The publication attributes this property to the high number of negative instance samples available for providing supervisory signal on \u003cem\u003eone another\u003c/em\u003e within a minibatch.\u003c/p\u003e\n\u003cp\u003eAccording to the developers of the \u003ca href=\"https://github.com/HobbitLong/SupContrast\"\u003eofficial implementation\u003c/a\u003e, at small minibatch sizes, a \u003ca href=\"/vault/notes/uihquvh4fwgniynh3aly42g\"\u003emomentum encoder\u003c/a\u003e and dictionary are necessary to attain competitive performance. However, it should be possible to offset this technical overhead and hyperparameter sensitivity in a multi-device training regime by performing a rendezvous to synchronize replicated latent representations across minibatches with functionality such as \u003ccode\u003ejax.lax.all_gather\u003c/code\u003e, or by adding more positive examples with strong data augmentation, akin to a supervised form of \u003ca href=\"/vault/notes/uihquvh4fwgniynh3aly42g#fast-moco\"\u003eFast-MoCo\u003c/a\u003e. \u003c/p\u003e\n\u003cp\u003eIt is unclear how the added positive examples would affect stability or performance— particularly with noisy labels or multiple labels assigned to training instances. To help correct for this, and because the supervisory signal may come from an underlying symbolic hierarchy with this method, it may be worth exploring projection of this method's latent embedding space onto a \u003ca href=\"/vault/notes/ikhbh5ldwpxjjb3ev2aacu0\"\u003ePoincaré ball\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/vault/assets/images/supcon.png\" alt=\"Supervised Contrastive Learning\"\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cstrong\u003eBacklinks\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/vault/notes/jc56h8njgqawadlroex4ju1\"\u003eContrastive Learning (vault)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/vault/notes/63z6zjmnp5tg1pj2rwcfb2f\"\u003eContrastive Language-Image Pretraining (vault)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/vault/notes/uihquvh4fwgniynh3aly42g\"\u003eMomentum Contrast (vault)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/vault/notes/ikhbh5ldwpxjjb3ev2aacu0\"\u003eHyperbolic Geometry (vault)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"ihfr21mlvz5lp3n62uu344t","title":"kavlogs","desc":"","updated":1659115143090,"created":1659018913792,"custom":{"nav_order":0,"permalink":"/"},"fname":"ref","type":"note","vault":{"fsPath":"vault"},"contentHash":"41b7e8cfe841b035025dfa85ec0b142e","links":[],"anchors":{},"children":["39acu8nb3xn6t18xul0ji8d","jc56h8njgqawadlroex4ju1","wf5gku64lj2ag6n8kzs9o8f","jlbuz8giyj93jsc1l0lmbzs","3c09ct2zvlk9dfitxexbss3"],"parent":null,"data":{},"body":"This is an assorted collection of notes and thoughts on things I've read about before. Here for my reference, and so that you can come here to read my background instead of receiving an untimely info-dump whose content just amounts to a recitation of anything here, out of mutual respect for my time and yours."},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"},{"fsPath":"projects"},{"fsPath":"tenets"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableHandlebarTemplates":true,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"enableSmartRefs":true,"dendronVersion":"0.105.1"},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":true},"publishing":{"theme":"dark","enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteUrl":"https://kavorite.github.io","assetsPrefix":"/vault","siteHierarchies":["ref","pub"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"⚑","description":"kavlogs"},"github":{"enableEditLink":false,"editBranch":"main","editViewMode":"tree","editLinkText":"Edit this page on GitHub"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"siteFaviconPath":"favicon.ico","siteIndex":"ref"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"9cismp3jsqbqx1pyso6xdc4"},"buildId":"x67zoUTAB0zyGOxjfffun","assetPrefix":"/vault","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>